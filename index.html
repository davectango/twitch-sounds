<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Tango Sound Commands</title>

<style>
html, body {
    margin: 0;
    padding: 0;
    background: white;
    font-family: Arial, sans-serif;
}

/* PANEL */
.panel {
    padding: 40px;
}

/* TOGGLE SWITCH */
.switch {
  position: relative;
  display: inline-block;
  width: 60px;
  height: 34px;
}

.switch input {
  display: none;
}

.slider {
  position: absolute;
  cursor: pointer;
  top: 0; left: 0; right: 0; bottom: 0;
  background-color: red;
  transition: .4s;
  border-radius: 34px;
}

.slider:before {
  position: absolute;
  content: "";
  height: 26px;
  width: 26px;
  left: 4px;
  bottom: 4px;
  background-color: white;
  transition: .4s;
  border-radius: 50%;
}

input:checked + .slider {
  background-color: #00cc44;
}

input:checked + .slider:before {
  transform: translateX(26px);
}

.status {
  margin-top: 20px;
  font-size: 18px;
}
</style>
</head>

<body>
<div class="panel">

<label class="switch">
  <input type="checkbox" id="enableToggle">
  <span class="slider"></span>
</label>

<div class="status" id="statusText">OFF</div>
<div>Click the switch once before stream, then you can minimize this window.</div>

</div>

<script type="module">
import tmi from "https://esm.sh/tmi.js@1.8.5";

const channelName = "tangoplaysdead";

const soundMap = {
    "!bruh": "https://www.myinstants.com/media/sounds/movie_1.mp3",
    "!horn": "https://www.myinstants.com/media/sounds/airhorn.mp3",
    "!spin": "https://www.myinstants.com/media/sounds/slot-machine.mp3"
};

let enabled = false;
let lastPlay = 0;
const COOLDOWN_MS = 2000;

const toggle = document.getElementById("enableToggle");
const statusText = document.getElementById("statusText");

toggle.addEventListener("change", () => {
    enabled = toggle.checked;
    statusText.textContent = enabled ? "ON - Connected" : "OFF";
});

function playSound(url) {
    const now = Date.now();
    if (now - lastPlay < COOLDOWN_MS) return;
    lastPlay = now;

    const audio = new Audio(url);
    audio.volume = 0.9;
    audio.play().catch(() => {});
}

const client = new tmi.Client({
    channels: [channelName]
});

await client.connect();

client.on("message", (channel, tags, message, self) => {
    if (self || !enabled) return;

    const cmd = message.trim().split(" ")[0].toLowerCase();
    const url = soundMap[cmd];
    if (url) playSound(url);
});
</script>
</body>
</html>
